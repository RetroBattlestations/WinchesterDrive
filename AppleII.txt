 10  ROT= 0: SCALE= 1 20 SH = 25000:D$ =  CHR$ (4) 30  PRINT D$;"BLOADSHAPES.BIN,A";SH 40  POKE 232,SH -  INT (SH / 256) * 256 50  POKE 233, INT (SH / 256) 100  GOSUB 2010 110 X = W / 2 - 1:Y = H / 2 - 1:FC = 0:FL = FC 115  GOSUB 1000 120 KE$ = "":NX = X:NY = Y 130  IF  PEEK (49152) < 128 THEN 130 140  GET KE$ 150  IF KE$ = "i" OR KE$ = "I" THEN NY = Y - 1:FC =  INT (FC / 2) * 2 + 1: IF NY < 0 THEN NY = 0: IF NX = W / 2 - 1 AND  MID$ (DR$,1,1) <  > " " THEN  GOSUB 2010:NX = W / 2 - 1:NY = H - 2: GOTO 210 160  IF KE$ = "j" OR KE$ = "J" THEN NX = X - 1:FC = FC -  INT (FC / 2) * 2 + 2: IF NX < 0 THEN NX = 0: IF NY = H / 2 - 1 AND  MID$ (DR$,3,1) <  > " " THEN  GOSUB 2010:NX = W - 2:NY = H / 2 - 1: GOTO 210 170  IF KE$ = "k" OR KE$ = "K" THEN NX = X + 1:FC = FC -  INT (FC / 2) * 2: IF NX > W - 2 THEN NX = W - 2: IF NY = H / 2 - 1 AND  MID$ (DR$,4,1) <  > " " THEN  GOSUB 2010:NX = 0:NY = H / 2 - 1: GOTO 210 180  IF KE$ = "m" OR KE$ = "M" THEN NY = Y + 1:FC =  INT (FC / 2) * 2: IF NY > H - 2 THEN NY = H - 2: IF NX = W / 2 - 1 AND  MID$ (DR$,2,1) <  > " " THEN  GOSUB 2010:NX = W / 2 - 1:NY = 0: GOTO 210 190  IF NX = X AND NY = Y THEN 120 200  GOSUB 1500 210 X = NX:Y = NY:FL = FC: GOSUB 1000 220  GOTO 120 999  END  1000 XP = X * 16 + 8 + XO:YP = Y * 16 + 8 + YO 1010  ON FC + 1 GOTO 1020,1030,1040,1050 1020  HCOLOR= 7: DRAW 1 AT XP + 1,YP + 2: DRAW 3 AT XP + 2,YP + 15: HCOLOR= 3: DRAW 2 AT XP + 3,YP + 10: RETURN  1030  HCOLOR= 7: DRAW 4 AT XP + 1,YP + 2: DRAW 6 AT XP + 2,YP + 12: HCOLOR= 3: DRAW 5 AT XP + 3,YP + 8: RETURN  1040  HCOLOR= 7: DRAW 7 AT XP + 13,YP + 2: DRAW 9 AT XP + 10,YP + 15: HCOLOR= 3: DRAW 8 AT XP + 12,YP + 10: RETURN  1050  HCOLOR= 7: DRAW 10 AT XP + 13,YP + 2: DRAW 12 AT XP + 10,YP + 15: HCOLOR= 3: DRAW 11 AT XP + 11,YP + 8: RETURN  1060  STOP  1500 XP = X * 16 + 8 + XO:YP = Y * 16 + 8 + YO 1510  ON FL + 1 GOTO 1520,1530,1540,1550 1520  HCOLOR= 0: DRAW 1 AT XP + 1,YP + 2: DRAW 2 AT XP + 3,YP + 10: DRAW 3 AT XP + 2,YP + 15: RETURN  1530  HCOLOR= 0: DRAW 4 AT XP + 1,YP + 2: DRAW 5 AT XP + 3,YP + 8: DRAW 6 AT XP + 2,YP + 12: RETURN  1540  HCOLOR= 0: DRAW 7 AT XP + 13,YP + 2: DRAW 8 AT XP + 12,YP + 10: DRAW 9 AT XP + 10,YP + 15: RETURN  1550  HCOLOR= 0: DRAW 10 AT XP + 13,YP + 2: DRAW 11 AT XP + 11,YP + 8: DRAW 12 AT XP + 10,YP + 15: RETURN  2000  REM    Create room 2005  HGR : POKE 49234,0 2010 W =  INT ( RND (1) * 4) * 2 + 6:H =  INT ( RND (1) * 4) * 2 + 6 2011 CN =  INT ( RND (1) * 3) 2015 XO = (280 - W * 16) / 2:YO = (192 - H * 16) / 2 2020 WC = 1 +  INT ( RND (1) * 4): IF WC > 2 THEN WC = WC + 2 2025  HCOLOR= WC 2030  FOR I = 0 TO 3 2040  HPLOT XO + 16,YO + I TO XO + (W - 1) * 16,YO + I 2050  HPLOT XO + 16,YO + I + H * 16 - 4 TO XO + (W - 1) * 16,YO + I + H * 16 - 4 2060  HPLOT XO + I,YO + 16 TO XO + I,YO + (H - 1) * 16 2070  HPLOT XO + I + W * 16 - 4,YO + 16 TO XO + I + W * 16 - 4,YO + (H - 1) * 16 2080  NEXT  2081  ROT= 48: DRAW CN + 13 AT XO,YO + 15: ROT= 32: DRAW CN + 13 AT XO + 15,YO + H * 16 - 1 2084  ROT= 16: DRAW CN + 13 AT XO + W * 16 - 1,YO + (H - 1) * 16: ROT= 0: DRAW CN + 13 AT XO + (W - 1) * 16,YO 2090 DR =  INT ( RND (1) * 16): IF  NOT DR GOTO 2090 2100 DR$ = "":DS$ = " N S W E" 2110  FOR I = 1 TO 4 2120 DD = DR -  INT (DR / 2) * 2:DR =  INT (DR / 2):DR$ = DR$ +  MID$ (DS$,I * 2 - 1 + DD,1) 2130  IF  NOT DD THEN 2340 2140 NS = I < 3:S = I = 2:E = I = 4 2150  FOR J = 0 TO 3 2160  HCOLOR=  INT (WC / 4) * 4 2170 X1 = (W * 16 / (NS + 1)) * (NS + E) - 12 * NS - 4 * E + J * (1 - NS) 2180 X2 = (W * 16 / (NS + 1)) * (NS + E) + 11 * NS - 4 * E + J * (1 - NS) 2190 Y1 = (H * 16 / ((1 - NS) + 1)) * ((1 - NS) + S) - 12 * (1 - NS) - 4 * S + J * NS 2200 Y2 = (H * 16 / ((1 - NS) + 1)) * ((1 - NS) + S) + 11 * (1 - NS) - 4 * S + J * NS 2210  HPLOT XO + X1,YO + Y1 TO XO + X2,YO + Y2 2220  HCOLOR=  INT (WC / 4) * 4 + 3 2230 X1 = (W * 16 / (NS + 1)) * (NS + E) - 16 * NS - 8 * E + J * NS 2240 X2 = (W * 16 / (NS + 1)) * (NS + E) - 16 * NS - 8 * E + 7 * (1 - NS) + J * NS 2250 Y1 = (H * 16 / (1 - NS + 1)) * (1 - NS + S) - 16 * (1 - NS) - 8 * S + J * (1 - NS) 2260 Y2 = (H * 16 / (1 - NS + 1)) * (1 - NS + S) - 16 * (1 - NS) - 8 * S + 7 * NS + J * (1 - NS) 2270  HPLOT XO + X1,YO + Y1 TO XO + X2,YO + Y2 2280 X1 = (W * 16 / (NS + 1)) * (NS + E) + 12 * NS - 8 * E + J * NS 2290 X2 = (W * 16 / (NS + 1)) * (NS + E) + 12 * NS - 8 * E + 7 * (1 - NS) + J * NS 2300 Y1 = (H * 16 / (1 - NS + 1)) * (1 - NS + S) + 12 * (1 - NS) - 8 * S + J * (1 - NS) 2310 Y2 = (H * 16 / (1 - NS + 1)) * (1 - NS + S) + 12 * (1 - NS) - 8 * S + 7 * NS + J * (1 - NS) 2320  HPLOT XO + X1,YO + Y1 TO XO + X2,YO + Y2 2330  NEXT J 2340  NEXT I 2350  RETURN 